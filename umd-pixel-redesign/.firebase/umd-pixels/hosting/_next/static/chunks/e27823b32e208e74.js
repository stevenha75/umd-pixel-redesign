(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},50630,93479,99682,9165,e=>{"use strict";var t=e.i(43476),r=e.i(22016),a=e.i(45678),n=e.i(18566);let s=[{href:"/admin",label:"Events"},{href:"/admin/members",label:"Members"},{href:"/admin/activities",label:"Activities"},{href:"/admin/settings",label:"Settings"}];function i({children:e}){let i=(0,n.usePathname)();return(0,t.jsxs)("div",{className:"min-h-screen bg-zinc-50",children:[(0,t.jsx)(a.default,{}),(0,t.jsxs)("div",{className:"mx-auto flex max-w-6xl gap-6 px-4 py-8",children:[(0,t.jsxs)("aside",{className:"hidden w-56 flex-shrink-0 rounded-2xl border border-zinc-200 bg-white p-4 shadow-sm md:block",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-zinc-900",children:"Admin"}),(0,t.jsx)("div",{className:"mt-4 flex flex-col gap-2 text-sm",children:s.map(e=>{let a=i===e.href;return(0,t.jsx)(r.default,{href:e.href,className:`rounded-lg px-3 py-2 font-medium ${a?"bg-black text-white":"text-zinc-800 hover:bg-zinc-100"}`,children:e.label},e.href)})})]}),(0,t.jsx)("main",{className:"flex-1",children:e})]})]})}e.s(["AdminLayout",()=>i],50630);var o=e.i(75157);function l({className:e,type:r,...a}){return(0,t.jsx)("input",{type:r,"data-slot":"input",className:(0,o.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...a})}e.s(["Input",()=>l],93479);var d=e.i(71645);function c(e){let t=d.useRef({value:e,previous:e});return d.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}e.s(["usePrevious",()=>c],99682),e.i(36180);var u=e.i(98925),p=e.i(59141);async function m(){let e=await (0,u.getDoc)((0,u.doc)(p.db,"settings","global")),t=e.data()?.currentSemesterId||null,r=t?(0,u.query)((0,u.collection)(p.db,"events"),(0,u.where)("semesterId","==",t),(0,u.orderBy)("date","desc")):(0,u.query)((0,u.collection)(p.db,"events"),(0,u.orderBy)("date","desc")),a=await (0,u.getDocs)(r),n=[],s=new Map,i=new Set;a.forEach(e=>{let t=e.data(),r=t.date?.toDate?.()??(t.date instanceof Date?t.date:new Date(t.date||Date.now())),a=t.name||"Event",o=t.attendees||[];o.forEach(e=>i.add(e)),n.push({id:e.id,name:a,date:r.toISOString(),type:t.type||"GBM",pixels:t.pixels||0,attendeesCount:o.length,attendees:[]}),s.set(e.id,a)});let o=await (0,u.getDocs)((0,u.query)((0,u.collectionGroup)(p.db,"excused_absences"),(0,u.orderBy)("createdAt","desc"))),l=[],d=new Set(i);o.forEach(e=>{let t=e.data(),r=e.ref.parent.parent?.id||"";l.push({id:e.id,eventId:r,eventName:s.get(r)||"Event",userId:t.userId||"",userName:"",userEmail:"",reason:t.reason||"",status:t.status||"pending"}),t.userId&&d.add(t.userId)});let c=new Map;return await Promise.all(Array.from(d).map(async e=>{let t=await (0,u.getDoc)((0,u.doc)(p.db,"users",e));if(t.exists()){let r=t.data(),a=`${r.firstName||""} ${r.lastName||""}`.trim()||"Member",n=r.email||r.slackEmail||"";c.set(e,{name:a,email:n})}})),l.forEach(e=>{let t=c.get(e.userId);t&&(e.userName=t.name,e.userEmail=t.email)}),n.forEach(e=>{let t=a.docs.find(t=>t.id===e.id),r=t?.data();e.attendees=(r?.attendees||[]).map(e=>{let t=c.get(e);return{id:e,name:t?.name||e,email:t?.email||""}})}),{events:n,excused:l,currentSemesterId:t}}async function f(e,t){let r=e.date?new Date(e.date):new Date,a=u.Timestamp.fromDate(r),n={name:e.name,semesterId:t||"",date:a,type:e.type,pixels:Number(e.pixels)||0,attendees:[]};return{id:(await (0,u.addDoc)((0,u.collection)(p.db,"events"),n)).id,name:n.name,date:r.toISOString(),type:n.type,pixels:n.pixels,attendeesCount:0}}async function x(e,t){let r=t.date?new Date(t.date):new Date,a=u.Timestamp.fromDate(r);return await (0,u.updateDoc)((0,u.doc)(p.db,"events",e),{name:t.name,type:t.type,pixels:Number(t.pixels)||0,date:a}),{id:e,name:t.name,date:r.toISOString(),type:t.type,pixels:Number(t.pixels)||0}}async function h(e){await (0,u.deleteDoc)((0,u.doc)(p.db,"events",e))}async function g(e,t){await (0,u.updateDoc)((0,u.doc)(p.db,"events",e),{pixels:Number(t)||0})}async function v(e,t,r){await (0,u.updateDoc)((0,u.doc)(p.db,"events",e,"excused_absences",t),{status:r})}async function y(e,t){await (0,u.updateDoc)((0,u.doc)(p.db,"events",e),{attendees:(0,u.arrayUnion)(t)})}async function b(e,t){await (0,u.updateDoc)((0,u.doc)(p.db,"events",e),{attendees:(0,u.arrayRemove)(t)})}async function w(e,t,r){let a=(0,u.doc)(p.db,"events",e);if("present"===r){await (0,u.updateDoc)(a,{attendees:(0,u.arrayUnion)(t)});let e=await (0,u.getDocs)((0,u.query)((0,u.collection)(a,"excused_absences"),(0,u.where)("userId","==",t)));await Promise.all(e.docs.map(e=>(0,u.deleteDoc)(e.ref)))}else if("excused"===r){await (0,u.updateDoc)(a,{attendees:(0,u.arrayRemove)(t)});let e=await (0,u.getDocs)((0,u.query)((0,u.collection)(a,"excused_absences"),(0,u.where)("userId","==",t)));e.empty?await (0,u.addDoc)((0,u.collection)(a,"excused_absences"),{userId:t,status:"approved",reason:"Marked excused by admin",createdAt:u.Timestamp.now()}):await Promise.all(e.docs.map(e=>(0,u.updateDoc)(e.ref,{status:"approved"})))}else{await (0,u.updateDoc)(a,{attendees:(0,u.arrayRemove)(t)});let e=await (0,u.getDocs)((0,u.query)((0,u.collection)(a,"excused_absences"),(0,u.where)("userId","==",t)));await Promise.all(e.docs.map(e=>(0,u.deleteDoc)(e.ref)))}}async function j(){return(await (0,u.getDocs)((0,u.query)((0,u.collection)(p.db,"users"),(0,u.orderBy)("pixelCached","desc")))).docs.map((e,t)=>{let r=e.data();return{id:e.id,firstName:r.firstName||"",lastName:r.lastName||"",email:r.email||r.slackEmail||"",pixels:r.pixelCached??r.pixels??0,pixelDelta:r.pixelDelta??r.pixeldelta??0,rank:t+1}})}async function D(e){return{id:(await (0,u.addDoc)((0,u.collection)(p.db,"users"),{...e,isAdmin:!1,pixelDelta:0,pixelCached:0,createdAt:u.Timestamp.now()})).id,...e,pixels:0,pixelDelta:0}}async function C(e,t){await (0,u.updateDoc)((0,u.doc)(p.db,"users",e),{firstName:t.firstName,lastName:t.lastName,email:t.email})}async function N(e){await (0,u.deleteDoc)((0,u.doc)(p.db,"users",e))}async function E(e,t){await (0,u.updateDoc)((0,u.doc)(p.db,"users",e),{isAdmin:t})}async function I(e,t){let r=Array.from(new Set(t.map(e=>e.trim()).filter(Boolean))),a=[];for(let e of r)(await (0,u.getDocs)((0,u.query)((0,u.collection)(p.db,"users"),(0,u.where)("email","==",e.toLowerCase())))).forEach(e=>a.push(e.id));return a.length&&await (0,u.updateDoc)((0,u.doc)(p.db,"events",e),{attendees:(0,u.arrayUnion)(...a)}),a}async function R(e){let t=(0,u.collection)(p.db,"activities"),r=e?(0,u.query)(t,(0,u.where)("semesterId","==",e),(0,u.orderBy)("name","asc")):(0,u.query)(t,(0,u.orderBy)("name","asc"));return(await (0,u.getDocs)(r)).docs.map(e=>{let t=e.data(),r=Object.entries(t.multipliers||{}).map(([e,t])=>({userId:e,multiplier:Number(t)}));return{id:e.id,name:t.name||"Activity",type:t.type||"other",pixels:t.pixels||0,semesterId:t.semesterId,multipliers:r}})}async function k(e){return{id:(await (0,u.addDoc)((0,u.collection)(p.db,"activities"),{...e,multipliers:{},createdAt:u.Timestamp.now()})).id,...e,multipliers:[]}}async function S(e,t){await (0,u.updateDoc)((0,u.doc)(p.db,"activities",e),{name:t.name,type:t.type,pixels:t.pixels,semesterId:t.semesterId})}async function _(e){await (0,u.deleteDoc)((0,u.doc)(p.db,"activities",e))}async function P(e,t,r){await (0,u.updateDoc)((0,u.doc)(p.db,"activities",e),{[`multipliers.${t}`]:r})}async function A(e){let t=await (0,u.getDocs)((0,u.query)((0,u.collection)(p.db,"users"),(0,u.where)("email","==",e.toLowerCase())));return t.empty?null:t.docs[0].id}async function O(e){let t=Array.from(new Set(e)),r=new Map;return await Promise.all(t.map(async e=>{let t=await (0,u.getDoc)((0,u.doc)(p.db,"users",e));if(t.exists()){let a=t.data(),n=`${a.firstName||""} ${a.lastName||""}`.trim()||"Member",s=a.email||a.slackEmail||"";r.set(e,{name:n,email:s})}})),r}e.s(["addAttendee",()=>y,"addAttendeesByEmail",()=>I,"addMember",()=>D,"createActivity",()=>k,"createEvent",()=>f,"deleteActivity",()=>_,"deleteEventById",()=>h,"deleteMember",()=>N,"fetchActivities",()=>R,"fetchAdminData",()=>m,"fetchMembers",()=>j,"fetchUserDetails",()=>O,"findUserIdByEmail",()=>A,"removeAttendee",()=>b,"setActivityMultiplier",()=>P,"setAdminFlag",()=>E,"setAttendanceStatus",()=>w,"updateActivity",()=>S,"updateEvent",()=>x,"updateEventPixels",()=>g,"updateExcusedStatus",()=>v,"updateMember",()=>C],9165)},57428,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(20783),n=e.i(81140),s=e.i(69340),i=e.i(99682),o=e.i(35804),l=e.i(96626);e.i(74080);var d=Symbol("radix.slottable");function c(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===d}var u=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,n)=>{var s,i;let o,l,d,u=(i=s=`Primitive.${n}`,(o=r.forwardRef((e,t)=>{let{children:n,...s}=e;if(r.isValidElement(n)){var i;let e,o,l=(i=n,(o=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(o=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),d=function(e,t){let r={...t};for(let a in t){let n=e[a],s=t[a];/^on[A-Z]/.test(a)?n&&s?r[a]=(...e)=>{let t=s(...e);return n(...e),t}:n&&(r[a]=n):"style"===a?r[a]={...n,...s}:"className"===a&&(r[a]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}(s,n.props);return n.type!==r.Fragment&&(d.ref=t?(0,a.composeRefs)(t,l):l),r.cloneElement(n,d)}return r.Children.count(n)>1?r.Children.only(null):null})).displayName=`${i}.SlotClone`,l=o,(d=r.forwardRef((e,a)=>{let{children:n,...s}=e,i=r.Children.toArray(n),o=i.find(c);if(o){let e=o.props.children,n=i.map(t=>t!==o?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,t.jsx)(l,{...s,ref:a,children:r.isValidElement(e)?r.cloneElement(e,void 0,n):null})}return(0,t.jsx)(l,{...s,ref:a,children:n})})).displayName=`${s}.Slot`,d),p=r.forwardRef((e,r)=>{let{asChild:a,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(a?u:n,{...s,ref:r})});return p.displayName=`Primitive.${n}`,{...e,[n]:p}},{}),p="Checkbox",[m,f]=function(e,a=[]){let n=[],s=()=>{let t=n.map(e=>r.createContext(e));return function(a){let n=a?.[e]||t;return r.useMemo(()=>({[`__scope${e}`]:{...a,[e]:n}}),[a,n])}};return s.scopeName=e,[function(a,s){let i=r.createContext(s),o=n.length;n=[...n,s];let l=a=>{let{scope:n,children:s,...l}=a,d=n?.[e]?.[o]||i,c=r.useMemo(()=>l,Object.values(l));return(0,t.jsx)(d.Provider,{value:c,children:s})};return l.displayName=a+"Provider",[l,function(t,n){let l=n?.[e]?.[o]||i,d=r.useContext(l);if(d)return d;if(void 0!==s)return s;throw Error(`\`${t}\` must be used within \`${a}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let n=a.reduce((t,{useScope:r,scopeName:a})=>{let n=r(e)[`__scope${a}`];return{...t,...n}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return a.scopeName=t.scopeName,a}(s,...a)]}(p),[x,h]=m(p);function g(e){let{__scopeCheckbox:a,checked:n,children:i,defaultChecked:o,disabled:l,form:d,name:c,onCheckedChange:u,required:m,value:f="on",internal_do_not_use_render:h}=e,[g,v]=(0,s.useControllableState)({prop:n,defaultProp:o??!1,onChange:u,caller:p}),[y,b]=r.useState(null),[w,j]=r.useState(null),D=r.useRef(!1),C=!y||!!d||!!y.closest("form"),E={checked:g,disabled:l,setChecked:v,control:y,setControl:b,name:c,form:d,value:f,hasConsumerStoppedPropagationRef:D,required:m,defaultChecked:!N(o)&&o,isFormControl:C,bubbleInput:w,setBubbleInput:j};return(0,t.jsx)(x,{scope:a,...E,children:"function"==typeof h?h(E):i})}var v="CheckboxTrigger",y=r.forwardRef(({__scopeCheckbox:e,onKeyDown:s,onClick:i,...o},l)=>{let{control:d,value:c,disabled:p,checked:m,required:f,setControl:x,setChecked:g,hasConsumerStoppedPropagationRef:y,isFormControl:b,bubbleInput:w}=h(v,e),j=(0,a.useComposedRefs)(l,x),D=r.useRef(m);return r.useEffect(()=>{let e=d?.form;if(e){let t=()=>g(D.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[d,g]),(0,t.jsx)(u.button,{type:"button",role:"checkbox","aria-checked":N(m)?"mixed":m,"aria-required":f,"data-state":E(m),"data-disabled":p?"":void 0,disabled:p,value:c,...o,ref:j,onKeyDown:(0,n.composeEventHandlers)(s,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,n.composeEventHandlers)(i,e=>{g(e=>!!N(e)||!e),w&&b&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})})});y.displayName=v;var b=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,name:n,checked:s,defaultChecked:i,required:o,disabled:l,value:d,onCheckedChange:c,form:u,...p}=e;return(0,t.jsx)(g,{__scopeCheckbox:a,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:c,name:n,form:u,value:d,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y,{...p,ref:r,__scopeCheckbox:a}),e&&(0,t.jsx)(C,{__scopeCheckbox:a})]})})});b.displayName=p;var w="CheckboxIndicator",j=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,forceMount:n,...s}=e,i=h(w,a);return(0,t.jsx)(l.Presence,{present:n||N(i.checked)||!0===i.checked,children:(0,t.jsx)(u.span,{"data-state":E(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:r,style:{pointerEvents:"none",...e.style}})})});j.displayName=w;var D="CheckboxBubbleInput",C=r.forwardRef(({__scopeCheckbox:e,...n},s)=>{let{control:l,hasConsumerStoppedPropagationRef:d,checked:c,defaultChecked:p,required:m,disabled:f,name:x,value:g,form:v,bubbleInput:y,setBubbleInput:b}=h(D,e),w=(0,a.useComposedRefs)(s,b),j=(0,i.usePrevious)(c),C=(0,o.useSize)(l);r.useEffect(()=>{if(!y)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!d.current;if(j!==c&&e){let r=new Event("click",{bubbles:t});y.indeterminate=N(c),e.call(y,!N(c)&&c),y.dispatchEvent(r)}},[y,j,c,d]);let E=r.useRef(!N(c)&&c);return(0,t.jsx)(u.input,{type:"checkbox","aria-hidden":!0,defaultChecked:p??E.current,required:m,disabled:f,name:x,value:g,form:v,...n,tabIndex:-1,ref:w,style:{...n.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function N(e){return"indeterminate"===e}function E(e){return N(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=D;var I=e.i(78784),R=e.i(75157);function k({className:e,...r}){return(0,t.jsx)(b,{"data-slot":"checkbox",className:(0,R.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(j,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,t.jsx)(I.CheckIcon,{className:"size-3.5"})})})}e.s(["Checkbox",()=>k],57428)},7585,e=>{"use strict";let t,r;var a,n=e.i(43476),s=e.i(71645),i=e.i(11870),o=e.i(50630),l=e.i(15288),d=e.i(19455),c=e.i(93479),u=e.i(57428);e.i(36180);var p=e.i(98925),m=e.i(59141),f=e.i(66027),x=e.i(9165),h=e.i(81140),g=e.i(20783),v=e.i(10772),y=e.i(69340),b=e.i(26330),w=e.i(65491),j=e.i(74606),D=e.i(96626);function C(e){var t;let r,a=(t=e,(r=s.forwardRef((e,t)=>{let{children:r,...a}=e;if(s.isValidElement(r)){var n;let e,i,o=(n=r,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),l=function(e,t){let r={...t};for(let a in t){let n=e[a],s=t[a];/^on[A-Z]/.test(a)?n&&s?r[a]=(...e)=>{let t=s(...e);return n(...e),t}:n&&(r[a]=n):"style"===a?r[a]={...n,...s}:"className"===a&&(r[a]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}(a,r.props);return r.type!==s.Fragment&&(l.ref=t?(0,g.composeRefs)(t,o):o),s.cloneElement(r,l)}return s.Children.count(r)>1?s.Children.only(null):null})).displayName=`${t}.SlotClone`,r),i=s.forwardRef((e,t)=>{let{children:r,...i}=e,o=s.Children.toArray(r),l=o.find(E);if(l){let e=l.props.children,r=o.map(t=>t!==l?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,n.jsx)(a,{...i,ref:t,children:s.isValidElement(e)?s.cloneElement(e,void 0,r):null})}return(0,n.jsx)(a,{...i,ref:t,children:r})});return i.displayName=`${e}.Slot`,i}e.i(74080);var N=Symbol("radix.slottable");function E(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===N}var I=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=C(`Primitive.${t}`),a=s.forwardRef((e,a)=>{let{asChild:s,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(s?r:t,{...i,ref:a})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{}),R=e.i(3536),k=e.i(85369),S=e.i(86312),_="Dialog",[P,A]=function(e,t=[]){let r=[],a=()=>{let t=r.map(e=>s.createContext(e));return function(r){let a=r?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...r,[e]:a}}),[r,a])}};return a.scopeName=e,[function(t,a){let i=s.createContext(a),o=r.length;r=[...r,a];let l=t=>{let{scope:r,children:a,...l}=t,d=r?.[e]?.[o]||i,c=s.useMemo(()=>l,Object.values(l));return(0,n.jsx)(d.Provider,{value:c,children:a})};return l.displayName=t+"Provider",[l,function(r,n){let l=n?.[e]?.[o]||i,d=s.useContext(l);if(d)return d;if(void 0!==a)return a;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=r.reduce((t,{useScope:r,scopeName:a})=>{let n=r(e)[`__scope${a}`];return{...t,...n}},{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}(a,...t)]}(_),[O,M]=P(_),$=e=>{let{__scopeDialog:t,children:r,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,d=s.useRef(null),c=s.useRef(null),[u,p]=(0,y.useControllableState)({prop:a,defaultProp:i??!1,onChange:o,caller:_});return(0,n.jsx)(O,{scope:t,triggerRef:d,contentRef:c,contentId:(0,v.useId)(),titleId:(0,v.useId)(),descriptionId:(0,v.useId)(),open:u,onOpenChange:p,onOpenToggle:s.useCallback(()=>p(e=>!e),[p]),modal:l,children:r})};$.displayName=_;var F="DialogTrigger",B=s.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=M(F,r),i=(0,g.useComposedRefs)(t,s.triggerRef);return(0,n.jsx)(I.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":ea(s.open),...a,ref:i,onClick:(0,h.composeEventHandlers)(e.onClick,s.onOpenToggle)})});B.displayName=F;var T="DialogPortal",[q,z]=P(T,{forceMount:void 0}),H=e=>{let{__scopeDialog:t,forceMount:r,children:a,container:i}=e,o=M(T,t);return(0,n.jsx)(q,{scope:t,forceMount:r,children:s.Children.map(a,e=>(0,n.jsx)(D.Presence,{present:r||o.open,children:(0,n.jsx)(j.Portal,{asChild:!0,container:i,children:e})}))})};H.displayName=T;var L="DialogOverlay",U=s.forwardRef((e,t)=>{let r=z(L,e.__scopeDialog),{forceMount:a=r.forceMount,...s}=e,i=M(L,e.__scopeDialog);return i.modal?(0,n.jsx)(D.Presence,{present:a||i.open,children:(0,n.jsx)(W,{...s,ref:t})}):null});U.displayName=L;var V=C("DialogOverlay.RemoveScroll"),W=s.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=M(L,r);return(0,n.jsx)(k.RemoveScroll,{as:V,allowPinchZoom:!0,shards:[s.contentRef],children:(0,n.jsx)(I.div,{"data-state":ea(s.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),G="DialogContent",K=s.forwardRef((e,t)=>{let r=z(G,e.__scopeDialog),{forceMount:a=r.forceMount,...s}=e,i=M(G,e.__scopeDialog);return(0,n.jsx)(D.Presence,{present:a||i.open,children:i.modal?(0,n.jsx)(Z,{...s,ref:t}):(0,n.jsx)(Q,{...s,ref:t})})});K.displayName=G;var Z=s.forwardRef((e,t)=>{let r=M(G,e.__scopeDialog),a=s.useRef(null),i=(0,g.useComposedRefs)(t,r.contentRef,a);return s.useEffect(()=>{let e=a.current;if(e)return(0,S.hideOthers)(e)},[]),(0,n.jsx)(X,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,h.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:(0,h.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:(0,h.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault())})}),Q=s.forwardRef((e,t)=>{let r=M(G,e.__scopeDialog),a=s.useRef(!1),i=s.useRef(!1);return(0,n.jsx)(X,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(a.current||r.triggerRef.current?.focus(),t.preventDefault()),a.current=!1,i.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(i.current=!0));let n=t.target;r.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}})}),X=s.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,...l}=e,d=M(G,r),c=s.useRef(null),u=(0,g.useComposedRefs)(t,c);return(0,R.useFocusGuards)(),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.FocusScope,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:i,onUnmountAutoFocus:o,children:(0,n.jsx)(b.DismissableLayer,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":ea(d.open),...l,ref:u,onDismiss:()=>d.onOpenChange(!1)})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eo,{titleId:d.titleId}),(0,n.jsx)(el,{contentRef:c,descriptionId:d.descriptionId})]})]})}),J="DialogTitle",Y=s.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=M(J,r);return(0,n.jsx)(I.h2,{id:s.titleId,...a,ref:t})});Y.displayName=J;var ee="DialogDescription";s.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=M(ee,r);return(0,n.jsx)(I.p,{id:s.descriptionId,...a,ref:t})}).displayName=ee;var et="DialogClose",er=s.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=M(et,r);return(0,n.jsx)(I.button,{type:"button",...a,ref:t,onClick:(0,h.composeEventHandlers)(e.onClick,()=>s.onOpenChange(!1))})});function ea(e){return e?"open":"closed"}er.displayName=et;var en="DialogTitleWarning",[es,ei]=(a={contentName:G,titleName:J,docsSlug:"dialog"},t=s.createContext(a),(r=e=>{let{children:r,...a}=e,i=s.useMemo(()=>a,Object.values(a));return(0,n.jsx)(t.Provider,{value:i,children:r})}).displayName=en+"Provider",[r,function(e){let r=s.useContext(t);if(r)return r;if(void 0!==a)return a;throw Error(`\`${e}\` must be used within \`${en}\``)}]),eo=({titleId:e})=>{let t=ei(en),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return s.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},el=({contentRef:e,descriptionId:t})=>{let r=ei("DialogDescriptionWarning"),a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return s.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(a))},[a,e,t]),null};let ed=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var ec=e.i(75157);function eu({...e}){return(0,n.jsx)($,{"data-slot":"dialog",...e})}function ep({...e}){return(0,n.jsx)(B,{"data-slot":"dialog-trigger",...e})}function em({...e}){return(0,n.jsx)(H,{"data-slot":"dialog-portal",...e})}function ef({className:e,...t}){return(0,n.jsx)(U,{"data-slot":"dialog-overlay",className:(0,ec.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function ex({className:e,children:t,showCloseButton:r=!0,...a}){return(0,n.jsxs)(em,{"data-slot":"dialog-portal",children:[(0,n.jsx)(ef,{}),(0,n.jsxs)(K,{"data-slot":"dialog-content",className:(0,ec.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...a,children:[t,r&&(0,n.jsxs)(er,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,n.jsx)(ed,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function eh({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"dialog-header",className:(0,ec.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function eg({className:e,...t}){return(0,n.jsx)(Y,{"data-slot":"dialog-title",className:(0,ec.cn)("text-lg leading-none font-semibold",e),...t})}function ev(){let[e,t]=(0,s.useState)(""),[r,a]=(0,s.useState)(!1),[h,g]=(0,s.useState)(!1),[v,y]=(0,s.useState)(null),[b,w]=(0,s.useState)(""),j=(0,f.useQuery)({queryKey:["admin-settings"],queryFn:async()=>(await (0,p.getDoc)((0,p.doc)(m.db,"settings","global"))).data()||{},staleTime:6e4});(0,s.useEffect)(()=>{j.data&&(t(j.data.currentSemesterId||""),a(!!j.data.isLeadershipOn))},[j.data]);let D=async()=>{g(!0),y(null);try{await (0,p.updateDoc)((0,p.doc)(m.db,"settings","global"),{currentSemesterId:e.trim(),isLeadershipOn:r}),y("Settings saved."),j.refetch()}catch(e){console.error(e),y("Failed to save settings.")}finally{g(!1)}},C=async()=>{if(b.trim()){g(!0),y(null);try{await (0,x.setAdminFlag)(b.trim(),!0),w(""),y("Admin access granted.")}catch(e){console.error(e),y("Failed to update admin.")}finally{g(!1)}}};return(0,n.jsx)(i.ProtectedRoute,{requireAdmin:!0,children:(0,n.jsx)(o.AdminLayout,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-6 pb-10",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Admin Settings"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage global settings for semesters and leaderboard visibility."})]}),(0,n.jsxs)(l.Card,{children:[(0,n.jsxs)(l.CardHeader,{children:[(0,n.jsx)(l.CardTitle,{children:"Semester & Leaderboard"}),(0,n.jsx)(l.CardDescription,{children:"Aligns with legacy admin settings."})]}),(0,n.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("label",{className:"text-sm text-muted-foreground",children:"Current Semester ID"}),(0,n.jsx)(c.Input,{value:e,onChange:e=>t(e.target.value),placeholder:"Enter semester document ID"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(u.Checkbox,{id:"leaderboard",checked:r,onCheckedChange:e=>a(!!e)}),(0,n.jsx)("label",{htmlFor:"leaderboard",className:"text-sm text-foreground",children:"Enable leaderboard visibility"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(d.Button,{onClick:D,disabled:h||j.isLoading,children:h?"Savingâ€¦":"Save settings"}),v&&(0,n.jsx)("span",{className:"text-sm text-muted-foreground",children:v})]})]})]}),(0,n.jsxs)(l.Card,{children:[(0,n.jsxs)(l.CardHeader,{children:[(0,n.jsx)(l.CardTitle,{children:"Admin access"}),(0,n.jsx)(l.CardDescription,{children:"Grant admin to a user ID."})]}),(0,n.jsxs)(l.CardContent,{className:"space-y-3",children:[(0,n.jsx)(c.Input,{value:b,onChange:e=>w(e.target.value),placeholder:"User ID"}),(0,n.jsx)(d.Button,{onClick:C,disabled:h,children:"Grant admin"})]})]}),(0,n.jsxs)(l.Card,{children:[(0,n.jsxs)(l.CardHeader,{children:[(0,n.jsx)(l.CardTitle,{children:"Archive & reset"}),(0,n.jsx)(l.CardDescription,{children:"Manual safeguards; no destructive defaults."})]}),(0,n.jsxs)(l.CardFooter,{className:"flex flex-col gap-2 md:flex-row md:items-center md:gap-3",children:[(0,n.jsxs)(eu,{children:[(0,n.jsx)(ep,{asChild:!0,children:(0,n.jsx)(d.Button,{variant:"outline",children:"Export CSV (members/events)"})}),(0,n.jsxs)(ex,{children:[(0,n.jsx)(eh,{children:(0,n.jsx)(eg,{children:"Export instructions"})}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Use the admin tables to export client-side CSVs (planned) or run Firestore export via CLI. No automated archive/reset is performed to avoid data loss."})]})]}),(0,n.jsxs)(eu,{children:[(0,n.jsx)(ep,{asChild:!0,children:(0,n.jsx)(d.Button,{variant:"outline",children:"Reset semester (manual)"})}),(0,n.jsxs)(ex,{children:[(0,n.jsx)(eh,{children:(0,n.jsx)(eg,{children:"Reset semester"})}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"To reset: 1) archive events/activities to a collection copy, 2) clear attendees, excused absences, multipliers, 3) set new `currentSemesterId`. This UI does not automate resets to prevent unintended data loss."})]})]})]})]})]})})})}e.s(["default",()=>ev],7585)}]);